{"version":3,"sources":["assets\\Script\\src\\decorators\\injects\\singleton\\JTSingletonClass.ts"],"names":[],"mappings":";;;;;;IAKA,IAAO,GAAG,CAgDT;IAhDD,WAAO,GAAG;QAOT,SAAgB,cAAc,CAAC,GAAO,EAAE,SAAyB;YAAzB,0BAAA,EAAA,iBAAyB;YAEhE,OAAO,UAAU,MAAU,EAAE,QAAe,EAAE,UAAe;gBAE5D,IAAI,UAAU,EACL;iBAER;qBAEQ;oBACP,2BAA2B,CAAC,GAAG,EAAE,MAAM,EAAE,QAAQ,EAAE,SAAS,CAAC,CAAC;iBAC/D;YACF,CAAC,CAAA;QACF,CAAC;QAbe,kBAAc,iBAa7B,CAAA;QAED,SAAgB,2BAA2B,CAAC,GAAO,EAAE,MAAU,EAAE,QAAe,EAAE,SAAyB;YAAzB,0BAAA,EAAA,iBAAyB;YAE1G,IAAI,GAAG,GAAU,gBAAgB,CAAC,kBAAkB,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;YACvE,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,QAAQ,EACtC;gBACC,GAAG,EAAE;oBAEJ,IAAI,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC;oBACpB,IAAI,GAAG,KAAK,IAAI,IAAI,GAAG,KAAK,SAAS,EACrC;wBACC,IAAI,MAAM,GAAsB,gBAAgB,CAAC,IAAI,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC;wBACtE,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,MAAM,CAAC,QAAQ,CAAC;wBACvC,MAAM,GAAG,IAAI,CAAC;qBACd;oBACD,OAAO,GAAG,CAAC;gBACZ,CAAC;gBACD,GAAG,EAAE,UAAU,GAAG;oBAEjB,IAAI,MAAM,GAAO,IAAI,CAAC,GAAG,CAAC,CAAC;oBAC3B,IAAI,GAAG,KAAK,MAAM;wBAAE,OAAO;oBAC3B,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;gBACjB,CAAC;gBACD,UAAU,EAAE,IAAI;gBAChB,YAAY,EAAE,IAAI;aAClB,CAAC,CAAC;QACJ,CAAC;QAzBe,+BAA2B,8BAyB1C,CAAA;IACF,CAAC,EAhDM,GAAG,KAAH,GAAG,QAgDT","file":"","sourceRoot":"/","sourcesContent":["\r\n\r\n/*\r\n* name;\r\n*/\r\nmodule com \r\n{\r\n    /**\r\n\t * 注入装饰器\r\n\t * @param cls 注入的单例类\r\n\t * @param destroyed 引用计数为0时，是否自动销毁\r\n\t */\r\n\texport function SingletonClass(cls:any, destroyed:boolean = false):Function\r\n    {\r\n\t\treturn function (target:any, property:string, descripter?:any) \r\n        {\r\n\t\t\tif (descripter) \r\n            {\r\n\t\t\t\t//  injectGetterSetter(cls, target, propertyName, descripter);\r\n\t\t\t}\r\n\t\t\telse \r\n            {\r\n\t\t\t\t registerSingletonClassAlias(cls, target, property, destroyed);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t \r\n\texport function registerSingletonClassAlias(cls:any, target:any, property:string, destroyed:boolean = false) \r\n\t{\r\n\t\tlet key:string = JTDecoratorUtils.registerClassAlias(target, property);\r\n\t\tObject.defineProperty(target, property, \r\n\t\t{\r\n\t\t\tget: function () \r\n\t\t\t{\r\n\t\t\t\tlet val = this[key];\r\n\t\t\t\tif (val === null || val === undefined) \r\n\t\t\t\t{\r\n\t\t\t\t\tlet _class:JTClassInjectAlias = JTDecoratorUtils.bind(cls, destroyed);\r\n\t\t\t\t\tval = this[property] = _class.instance;\r\n\t\t\t\t\t_class = null;\r\n\t\t\t\t}\r\n\t\t\t\treturn val;\r\n\t\t\t},\r\n\t\t\tset: function (val) \r\n\t\t\t{\r\n\t\t\t\tlet oldVal:any = this[key];\r\n\t\t\t\tif (val === oldVal) return;\r\n\t\t\t\tthis[key] = val;\r\n\t\t\t},\r\n\t\t\tenumerable: true,\r\n\t\t\tconfigurable: true\r\n\t\t});\r\n\t}\r\n}\r\n\r\n\r\n\r\n"]}