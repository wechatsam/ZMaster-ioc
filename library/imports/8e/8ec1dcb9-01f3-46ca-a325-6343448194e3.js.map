{"version":3,"sources":["assets\\Script\\src\\decorators\\injects\\singleton\\JTSingletonPool.ts"],"names":[],"mappings":";;;;;;IAKA,IAAO,GAAG,CAiDT;IAjDD,WAAO,GAAG;QAQT,SAAgB,aAAa,CAAC,OAAW,EAAE,OAAW,EAAE,UAAe;YAEtE,OAAO,UAAU,MAAU,EAAE,QAAe,EAAE,UAAe;gBAE5D,IAAI,UAAU,EACL;iBAER;qBAEQ;oBACP,0BAA0B,CAAC,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,OAAO,EAAE,UAAU,CAAC,CAAC;iBAC5E;YACF,CAAC,CAAA;QACF,CAAC;QAbe,iBAAa,gBAa5B,CAAA;QAED,SAAgB,0BAA0B,CAAC,OAAW,EAAE,MAAU,EAAE,QAAe,EAAE,OAAW,EAAE,UAAe;YAEhH,IAAI,GAAG,GAAU,gBAAgB,CAAC,kBAAkB,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;YACvE,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,QAAQ,EACtC;gBACC,GAAG,EAAE;oBAEJ,IAAI,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC;oBACpB,IAAI,GAAG,KAAK,IAAI,IAAI,GAAG,KAAK,SAAS,EACrC;wBACC,IAAI,MAAM,GAAsB,gBAAgB,CAAC,QAAQ,CAAC,OAAO,EAAE,OAAO,EAAE,UAAU,CAAC,CAAC;wBACxF,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,MAAM,CAAC,QAAQ,CAAC;wBACvC,MAAM,GAAG,IAAI,CAAC;qBACd;oBACD,OAAO,GAAG,CAAC;gBACZ,CAAC;gBACD,GAAG,EAAE,UAAU,GAAG;oBAEjB,IAAI,MAAM,GAAO,IAAI,CAAC,GAAG,CAAC,CAAC;oBAC3B,IAAI,GAAG,KAAK,MAAM;wBAAE,OAAO;oBAC3B,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;gBACjB,CAAC;gBACD,UAAU,EAAE,IAAI;gBAChB,YAAY,EAAE,IAAI;aAClB,CAAC,CAAC;QACJ,CAAC;QAzBe,8BAA0B,6BAyBzC,CAAA;IACF,CAAC,EAjDM,GAAG,KAAH,GAAG,QAiDT","file":"","sourceRoot":"/","sourcesContent":["\r\n\r\n/*\r\n* name;\r\n*/\r\nmodule com \r\n{\r\n    /**\r\n\t * 注入装饰器\r\n\t * @param poolCls\r\n\t * @param itemCls 注入的单例类\r\n\t * @param destroyed 引用计数为0时，是否自动销毁\r\n\t */\r\n\texport function SingletonPool(poolCls:any, itemCls:any, parameters?:any):Function\r\n    {\r\n\t\treturn function (target:any, property:string, descripter?:any) \r\n        {\r\n\t\t\tif (descripter) \r\n            {\r\n\t\t\t\t//  injectGetterSetter(cls, target, propertyName, descripter);\r\n\t\t\t}\r\n\t\t\telse \r\n            {\r\n\t\t\t\t registerSingletonPoolAlisa(poolCls, target, property, itemCls, parameters);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t \r\n\texport function registerSingletonPoolAlisa(poolCls:any, target:any, property:string, itemCls:any, parameters?:any) \r\n\t{\r\n\t\tlet key:string = JTDecoratorUtils.registerClassAlias(target, property);\r\n\t\tObject.defineProperty(target, property, \r\n\t\t{\r\n\t\t\tget: function () \r\n\t\t\t{\r\n\t\t\t\tlet val = this[key];\r\n\t\t\t\tif (val === null || val === undefined) \r\n\t\t\t\t{\r\n\t\t\t\t\tlet _class:JTClassInjectAlias = JTDecoratorUtils.bindPool(poolCls, itemCls, parameters);\r\n\t\t\t\t\tval = this[property] = _class.instance;\r\n\t\t\t\t\t_class = null;\r\n\t\t\t\t}\r\n\t\t\t\treturn val;\r\n\t\t\t},\r\n\t\t\tset: function (val) \r\n\t\t\t{\r\n\t\t\t\tlet oldVal:any = this[key];\r\n\t\t\t\tif (val === oldVal) return;\r\n\t\t\t\tthis[key] = val;\r\n\t\t\t},\r\n\t\t\tenumerable: true,\r\n\t\t\tconfigurable: true\r\n\t\t});\r\n\t}\r\n}\r\n\r\n\r\n\r\n"]}