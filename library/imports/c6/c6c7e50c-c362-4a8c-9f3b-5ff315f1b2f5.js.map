{"version":3,"sources":["assets\\Script\\src\\time\\frames\\JTEnterFrame.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["namespace com \r\n{\r\n    //传统帧事件\r\n    export class JTEnterFrame extends JTTimerTask implements JTIEnterFrame\r\n    {\r\n        protected _frameRate:number = 0;\r\n        protected _loop:number = 0;\r\n        protected _loopTimes:number = 0;\r\n        protected SECOND_INTERVAL:number = 1000;\r\n        protected DEFAULT_FRAME_RATE:number = 60;\r\n        protected DEFAULT_FRAME_RATE_TIME:number = 16;\r\n        constructor()\r\n        {\r\n            super(0, 0);\r\n        }\r\n\r\n        public get loop():number\r\n        {\r\n            return this._loop;\r\n        }\r\n\r\n        public get frameRate():number\r\n        {\r\n            return this._frameRate;\r\n        }\r\n\r\n        public setup(totalFrames:number, loop:number = 0, frameRate:number = 60):void\r\n        {\r\n            this._loopTimes = 0;\r\n            this._loop = loop;\r\n            this._totalTimes = totalFrames;\r\n            this.adjustFrameRate(frameRate);\r\n        }\r\n\r\n        public play(totalFrames:number, loop:number = 0, frameRate:number = 60):void\r\n        {\r\n            this._running = true;\r\n            this.setup(totalFrames, loop, frameRate);\r\n            JTTimerTool.animationTimer.addTask(this);//加入到动画对列里\r\n        }\r\n\r\n        protected adjustFrameRate(value:number):void\r\n        {\r\n            this._interval = value  == this.DEFAULT_FRAME_RATE ? this.DEFAULT_FRAME_RATE_TIME : this.SECOND_INTERVAL / value;\r\n            this._frameRate = value;\r\n        }\r\n\r\n        public stop():void\r\n        {\r\n            this._running = false; \r\n        }\r\n\r\n        public pause():void\r\n        {\r\n            this._running = false; \r\n        }\r\n\r\n        public get currentLoop():number\r\n        {\r\n            return this._loopTimes;\r\n        }\r\n\r\n        public get currentFrame():number\r\n        {\r\n            return this._currentTimes;\r\n        }\r\n\r\n        public get totalFrame():number\r\n        {\r\n            return this._totalTimes;\r\n        }\r\n\r\n        public updateTick(tick:number):void\r\n        {\r\n            this._currentTick += tick; //叠加时间\r\n            let count:number = Math.floor(this._currentTick / this._interval);//取最小延迟次数-不进行四舍五入，也不直接上向补位，把时间节点留到下次叠加\r\n            if (count > 0) //延迟次数\r\n            {\r\n                for (let i:number = 0; i < count; i++)\r\n                {\r\n                    this._currentTimes ++;\r\n                    this._currentTick -= this._interval;\r\n                    this.dispatchEvent(JTTimeEvent.ENTER_FRAME, this);\r\n                    if (this._currentTimes >= this._totalTimes)\r\n                    {\r\n                        this._loopTimes ++;\r\n                        if (this._loop == 0)this._currentTimes = 0;\r\n                        else\r\n                        {\r\n                            if (this._loopTimes >= this._loop && this._loop != 0)\r\n                            {\r\n                                this._running = false;\r\n                                this.dispatchEvent(JTTimeEvent.ENTER_COMPLETE, this);\r\n                                break;\r\n                            }\r\n                            else\r\n                            {\r\n                                this._currentTimes = 0;\r\n                                this.dispatchEvent(JTTimeEvent.ENTER_LAST_FRAME, this);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        public static create():JTIEnterFrame\r\n        {\r\n            let timer:JTIEnterFrame = JTPool.instance(JTEnterFrame).get() as JTIEnterFrame;\r\n            return timer;\r\n        } \r\n\r\n        public static put(timer:JTIEnterFrame):void\r\n        {\r\n            JTTimerTool.defaultTimer.removeTask(timer as any);\r\n            JTPool.instance(JTEnterFrame).put(timer as JTIEnterFrame);\r\n        }\r\n    }\r\n\r\n}\r\n"]}